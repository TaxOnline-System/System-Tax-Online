<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏†‡∏≤‡∏©‡∏µ‡πÅ‡∏°‡πà‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    .fade-in { animation: fadeIn 1s ease-in; }
    @keyframes fadeIn {
      0% { opacity: 0; transform: translateY(10px); }
      100% { opacity: 1; transform: translateY(0); }
    }
    body {
      background: linear-gradient(-45deg, #e0c3fc, #8ec5fc, #fbc2eb, #a1c4fd);
      background-size: 400% 400%;
      animation: gradientAnimation 15s ease infinite;
    }
    @keyframes gradientAnimation {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
  </style>
</head>
<body class="font-sans">
  <div class="fixed top-4 left-4 z-50 bg-white dark:bg-gray-800 text-sm text-gray-700 dark:text-white px-3 py-1 rounded shadow">
    <span id="datetime">--:--</span>
  </div>
  <div class="fixed top-4 right-4 z-50">
    <button onclick="toggleDarkMode()" class="bg-white dark:bg-gray-700 text-gray-700 dark:text-white px-4 py-2 rounded shadow text-sm font-medium">
      üåô Toggle Dark Mode
    </button>
  </div>

  <header class="bg-white dark:bg-gray-900 shadow p-4 fade-in">
    <div class="max-w-6xl mx-auto flex flex-col sm:flex-row justify-between items-center">
      <h1 class="text-2xl font-bold text-pink-600 dark:text-yellow-300 mb-2 sm:mb-0">TaxOnline</h1>
      <nav class="text-center sm:text-right space-x-3">
        <a href="index.html" class="text-pink-600 dark:text-yellow-400 hover:underline">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a>
        <a href="history.html" class="text-gray-600 dark:text-gray-200 hover:underline">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</a>
        <a href="profile.html" class="text-gray-600 dark:text-gray-200 hover:underline">‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå</a>
        <a href="login.html" class="text-blue-600 dark:text-yellow-400 hover:underline font-semibold">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</a>
      </nav>
    </div>
  </header>

  <section class="text-center py-12 px-6 sm:px-12 fade-in">
    <h2 class="text-3xl sm:text-4xl font-bold text-pink-700 dark:text-yellow-300 mb-4">
      ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏†‡∏≤‡∏©‡∏µ‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå <br class="sm:hidden" /> ‡∏á‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 1 ‡∏ô‡∏≤‡∏ó‡∏µ!
    </h2>
    <p class="text-gray-700 dark:text-gray-300 text-base sm:text-lg max-w-2xl mx-auto">
      ‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏ä‡πà‡∏ß‡∏¢‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏†‡∏≤‡∏©‡∏µ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ‡∏û‡πà‡∏≠‡∏Ñ‡πâ‡∏≤ ‡πÅ‡∏°‡πà‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ü‡∏£‡∏µ ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢
    </p>
    <div class="mt-6">
      <a href="#calculator" class="bg-pink-500 hover:bg-pink-600 text-white px-6 py-3 rounded-full text-lg shadow transition">
        ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏•‡∏¢
      </a>
    </div>
  </section>

  <section id="calculator" class="px-4 sm:px-6 fade-in">
    <div class="max-w-md mx-auto bg-white dark:bg-gray-900 p-6 sm:p-8 rounded-2xl shadow-xl">
      <h3 class="text-xl sm:text-2xl font-semibold text-center text-blue-600 dark:text-purple-300 mb-4">‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏†‡∏≤‡∏©‡∏µ</h3>
      <form class="space-y-4" id="taxForm">
        <div>
          <label class="block text-sm font-medium text-gray-800 dark:text-gray-200">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏ö‡∏≤‡∏ó)</label>
          <input type="number" class="w-full p-2 border rounded-lg dark:bg-gray-800 dark:text-white" id="income" />
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-800 dark:text-gray-200">‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏ö‡∏≤‡∏ó)</label>
          <input type="number" class="w-full p-2 border rounded-lg dark:bg-gray-800 dark:text-white" id="expense" />
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-800 dark:text-gray-200">‡∏Ñ‡πà‡∏≤‡∏•‡∏î‡∏´‡∏¢‡πà‡∏≠‡∏ô (‡∏ö‡∏≤‡∏ó)</label>
          <input type="number" value="60000" class="w-full p-2 border rounded-lg dark:bg-gray-800 dark:text-white" id="deduction" />
        </div>
        <div class="mb-4">
          <label for="receiptUpload" class="block text-sm font-medium text-gray-800 dark:text-gray-200">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)</label>
          <input type="file" id="receiptUpload" accept="image/*,.pdf" multiple
            class="mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 dark:file:bg-gray-700 dark:file:text-white dark:hover:file:bg-gray-600">
          <p class="mt-1 text-xs text-gray-500 dark:text-gray-400">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå JPG, PNG, PDF ‡πÑ‡∏î‡πâ (‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡πÑ‡∏ü‡∏•‡πå)</p>
          <div id="fileInfo" class="mt-2 text-sm text-gray-700 dark:text-gray-300"></div>
          <div id="previewArea" class="mt-2 grid grid-cols-3 gap-2"></div>
        </div>
        <button type="submit" class="w-full bg-blue-600 text-white py-2 px-4 rounded-lg font-bold hover:bg-blue-700 transition">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏†‡∏≤‡∏©‡∏µ</button>
      </form>
      <div class="mt-6"><canvas id="taxPieChart"></canvas></div>
    </div>
  </section>

  <footer class="bg-white dark:bg-gray-900 mt-16 p-4 text-center text-sm text-gray-500 dark:text-gray-400 fade-in">
    &copy; 2025 ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏†‡∏≤‡∏©‡∏µ ‡∏û‡πà‡∏≠‡∏Ñ‡πâ‡∏≤ ‡πÅ‡∏°‡πà‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå
  </footer>

  <script>
    function toggleDarkMode() {
      document.documentElement.classList.toggle("dark");
      localStorage.setItem("theme", document.documentElement.classList.contains("dark") ? "dark" : "light");
    }

    (function () {
      if (localStorage.getItem("theme") === "dark") {
        document.documentElement.classList.add("dark");
      }
    })();

    function updateDateTime() {
      const now = new Date();
      const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
      const timeStr = now.toLocaleTimeString('th-TH');
      const dateStr = now.toLocaleDateString('th-TH', options);
      document.getElementById('datetime').innerText = `${dateStr} ${timeStr}`;
    }
    setInterval(updateDateTime, 1000);
    updateDateTime();

    document.getElementById('receiptUpload').addEventListener('change', function () {
      const files = this.files;
      const fileInfo = document.getElementById('fileInfo');
      const previewArea = document.getElementById('previewArea');

      fileInfo.innerText = `‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ${files.length} ‡πÑ‡∏ü‡∏•‡πå`;
      previewArea.innerHTML = '';

      for (let i = 0; i < files.length; i++) {
        const file = files[i];
        const reader = new FileReader();

        if (file.type.startsWith('image/')) {
          reader.onload = function (e) {
            const img = document.createElement('img');
            img.src = e.target.result;
            img.alt = file.name;
            img.className = 'w-full h-24 object-cover rounded shadow';
            previewArea.appendChild(img);
          };
          reader.readAsDataURL(file);
        } else {
          const fileLabel = document.createElement('p');
          fileLabel.textContent = `üìÑ ${file.name}`;
          fileLabel.className = 'text-xs text-gray-700 dark:text-gray-300';
          previewArea.appendChild(fileLabel);
        }
      }
    });

    function calculateTax(income, expense, deduction) {
      let netIncome = income - expense - deduction;
      return netIncome <= 150000 ? 0 : netIncome * 0.05;
    }

    document.getElementById("taxForm").addEventListener("submit", function (e) {
      e.preventDefault();
      const income = parseFloat(document.getElementById("income").value);
      const expense = parseFloat(document.getElementById("expense").value);
      const deduction = parseFloat(document.getElementById("deduction").value);

      if (isNaN(income) || isNaN(expense) || isNaN(deduction)) {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç");
        return;
      }

      const tax = calculateTax(income, expense, deduction);
      const ctx = document.getElementById('taxPieChart').getContext('2d');
      if (window.taxChart instanceof Chart) window.taxChart.destroy();

      const taxPercentage = (income - expense - deduction > 150000) ? 100 : 0;
      window.taxChart = new Chart(ctx, {
        type: 'pie',
        data: {
          labels: ['‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ', '‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ'],
          datasets: [{
            data: [taxPercentage, 100 - taxPercentage],
            backgroundColor: ['#ef4444', '#22c55e'],
            hoverOffset: 4
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { position: 'top' },
            title: {
              display: true,
              text: `‡∏†‡∏≤‡∏©‡∏µ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ä‡∏≥‡∏£‡∏∞: ${tax.toLocaleString('th-TH')} ‡∏ö‡∏≤‡∏ó`,
              font: { size: 16 }
            }
          }
        }
      });
    });
  </script>
</body>
</html>
